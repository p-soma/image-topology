function patches = createPatchSample(n, cut_p, k, dim)
% function to create our main space M, a sample of n patches
%   param n: the number of patches per image
%   param m: the number of patches to extract from each image
%   param cut_p: percentage of most dense patches to keep
%   param k: density estimator
%   param dim: 9 or 81

    cut_p = 0.2;
    n_images = 1000;
    total_patches = n * cut_p * n_images;
    
    patches = zeros(total_patches,9);

    for i=1:1000
        filename = sprintf('image%05d.iml',i);
        buf = readIML(filename);
        newPatches = selectPatchesFromImage(buf, n, dim,cut_p);
        patches = cat(1,patches,newPatches);
    end

